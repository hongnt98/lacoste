import{objDataset as e,delegate as t,lockScroll as n}from"../base/croco.js";import{mediaQuery as r}from"../base/config.js";import{enableTransparentHeader as o}from"./header-transparent.js";import{Tracker as s}from"./event-tracker.js";function c(){let c=null,l=null;const a="is-opened",i="is-active",u="nav",m=".js-menu-item",f=".js-sub-nav",d=".js-nav-wrapper",p=".js-menu-breadcrumb",v=".js-menu-breadcrumb-item";function g(e){Array.from(l.querySelectorAll(`${d}.${i}`)).forEach(e=>{e.classList.remove(i)}),e&&e.querySelector(d)&&e.querySelector(d).classList.add(i)}function b(){document.documentElement.classList.remove("no-overflow"),o(!0),l.classList.remove(a),Array.from(l.querySelectorAll(`.${a}`)).forEach(e=>{e.classList.remove(a)}),g()}function j(e){e.preventDefault(),l.classList.add(a),g(l),n.lockAfterTransition(l),o(!1)}function y(t){const n=t.currentTarget,o=n.dataset.tagId;let c=n.dataset.replace;if(c&&(c=JSON.parse(c)),r.mobileAndTablet.matches){t.stopPropagation();const r=n.closest(m).querySelector(f);r?(t.preventDefault(),g(r),r.classList.add(a),function(t){const n=t.querySelector(p).querySelectorAll(v);if(n&&n.length>0&&e(n[0],u))return;let r=t;for(let o=n.length-1;o>=0;o--){const t=n[o];if(o!==n.length-1){const n=r.parentNode.closest(`.${a}`);e(t,u,n),r=n}else e(t,u,r)}}(r)):s.sendTracking(o,c)}else s.sendTracking(o,c)}function L(e){e.preventDefault(),e.stopPropagation();const t=e.target;t.closest(`.${a}`).classList.remove(a),g(t.closest(`.${a}`))}function h(t){t.preventDefault(),t.stopPropagation();const n=e(t.target,u);Array.from(n.querySelectorAll(`.${a}`)).forEach(e=>{e.classList.remove(a)}),g(n)}function k(e){e.preventDefault(),n.unlock(),l.classList.remove(a),b()}return{init(){if(l=document.querySelector(".js-menu-main"),c=document.querySelector(".js-menu-open"),function(){let e=!1,t=null;window.addEventListener("resize",function(){window.clearTimeout(t),t=window.setTimeout(()=>{!r.mobileAndTablet.matches&&e&&(b(),e=!1),r.mobileAndTablet.matches&&!e&&(e=!0)},200)})}(),l&&c){let e=l.querySelectorAll(".js-menu-item-link");for(let t=0,n=e.length;t<n;t++)e[t].addEventListener("click",y);c.addEventListener("click",j),t(l,".js-menu-back","click",L),t(l,v,"click",h),t(l,".js-menu-close","click",k)}}}}export function headerBurgerInit(){c().init()};